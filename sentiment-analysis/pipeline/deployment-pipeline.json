{
  "pipeline": {
    "name": "finbert-deploy"
  },
  "description": "Deploys a model into production via the KServe Python SDK.",
  "input": {
    "pfs": {
      "name": "data",
      "repo": "finbert-train",
      "branch": "master",
      "glob": "/"
    }
  },
  "transform": {
    "cmd": [
      "/bin/sh"
    ],
    "stdin": [
      "python deploy.py --deployment-name finbert-deploy --cloud-model-bucket kserve-models --cloud-model-host s3"
    ],
    "image": "hpelabssg/pdk:deploy_finbert_0.0.1",
    "secrets": [
      {
        "name": "pipeline-secret",
        "key": "det_master",
        "env_var": "DET_MASTER"
      },
      {
        "name": "pipeline-secret",
        "key": "det_user",
        "env_var": "DET_USER"
      },
      {
        "name": "pipeline-secret",
        "key": "det_password",
        "env_var": "DET_PASSWORD"
      },
      {
        "name": "pipeline-secret",
        "key": "kserve_namespace",
        "env_var": "KSERVE_NAMESPACE"
      },
      {
        "name": "pachyderm-determined-pipeline-secret",
        "key": "s3_endpoint",
        "env_var": "S3_ENDPOINT"
      },
      {
        "name": "pachyderm-determined-pipeline-secret",
        "key": "s3_access_key",
        "env_var": "S3_ACCESS_KEY"
      },
      {
        "name": "pachyderm-determined-pipeline-secret",
        "key": "s3_secret_key",
        "env_var": "S3_SECRET_KEY"
      },
      {
        "name": "pachyderm-determined-pipeline-secret",
        "key": "s3_secure",
        "env_var": "S3_SECURE"
      }	 
    ]
  },
  "pod_patch": "[  {   \"op\": \"add\",   \"path\": \"/volumes/-\",   \"value\": {    \"name\": \"det-checkpoints\",    \"hostpath\": {     \"path\": \"/mnt/mapr_nfs/determined/det_checkpoints\",     \"type\": \"Directory\"    }   }  },  {   \"op\": \"add\",   \"path\": \"/containers/0/volumeMounts/-\",   \"value\": {    \"mountPath\": \"/determined_shared_fs\",    \"name\": \"det-checkpoints\"   }  } ]"
}